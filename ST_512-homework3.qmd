---
title: "ST_512-homework3"
author: "Lindsay Dodson"
format: pdf
---

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(broom)
```

## Problem 1

**a**

```{r}
# x=7
25-0.5*7
```

**b**

```{r}
# x=3, y=30
25-0.5*3 

30-(25-0.5*3) #residual
```

The point is above the line because the residual is positive.

**c** If x increases 3 units, $\hat{y}$ decreases 1.5.

```{r}
-0.5*3
```

**d**

According to the linear model, it is predicted that the test score would be 22. The value 22 is the mean of all of probability curve of values that could occur when x=6. This is also just one linear model. 

**e**

```{r}
7/(16-2)
```

## Problem 2

**a**

|            |     |         |          |          |          |
|------------|-----|---------|----------|----------|----------|
| Source     | df  | SS      | MS       | F-value  | p-value  |
| Regression | 1   | 8654.7  | 8654.7   | 102.3481 |1.153E-15 |
| Error      | 75  | 6342.1  | 84.5613  |          |          |
| Total      | 76  | 14996.8 |          |          |          |

**b**

$R^2=\frac{SSR}{SST}$
```{r}
6342.1/14996.8
```
42.3% of the variation observed in rating is explained by sugar.

**c**

MSE estimates variance.

$\sigma^2=84.56$

**d**
F=102.35, f=0.003958545

Because F > f, we reject the null hypothesis, which means the linearity assumption is satisfied.

```{r}
qf(0.05,1,75) #check against excel=3.96 ?
```

## Problem 3 

```{r}
b_0<- 58.816
b_1<- -1.867
sb_1<- 0.346
MSE<-4.417
```

**a**
```{r}
t_val3<-abs(b_1/sb_1) # this is the t observed value, take absolute value
t_val3
t_cv<-qt(0.975,20-2) # one or two tail for alpha?
t_cv
## 2*(1-pt(t_val3,18)) # is df_error=n-p=20-2 ?
```
Because the t-value is greater than the t critical value (5.39>2.1), we reject the null hypothesis and conclude that there is a linear relationship.

**b**

```{r}
b_1-(t_cv*sb_1)
b_1+(t_cv*sb_1)
```
The 95% confidence interval for $\beta_1$ is (-2.59,-1.40).

**c**
```{r}
y_10<- b_0+b_1*10
y_10
sd_10<-0.7342
y_10-(t_cv*sd_10)
y_10+(t_cv*sd_10)
```
The 95% confidence interval is (38.60,41.69).

**d**
```{r}
sd_pred<-2.226 ##CHECK
y_10-(t_cv*sd_pred)
y_10+(t_cv*sd_pred)
```
The 95% prediction interval is (35.47,44.82).

## Problem 4

```{r}
gpa_data<-read.table(file.choose(), header=T)
names(gpa_data)
head(gpa_data)
tail(gpa_data)
attach(gpa_data)

```

**a**

```{r}
gpa_data|>
  summarise(mean_ACT=mean(ACT), mean_GPA=mean(GPA), var_ACT=var(ACT),var_GPA=var(GPA))
```

**b**

```{r}
cor(ACT, GPA)
```

The variables have a weak, positive correlation.

**c**

```{r}
model4<-lm(GPA~ACT)
plot(ACT, GPA)
abline(model4)
```

The relationship is approximately linear.

**d**

```{r}
model4

```

$\hat{GPA}=2.11405 + 0.03883*ACT$

**e**

When the entrance exam increases by 1, the GPA is estimated to increase by 0.03883

When the entrance exam increase by 4, the GPA is estimated to increase by 0.15532.

**f**

```{r}
 2.11405 + 0.03883*20
```

**g** estimate variance and std dev
```{r}
summary(model4)
```
MSE estimates $\sigma^2$.

$\sigma^2=(0.6231)^2=0.3882536$  ##Check seems small
$\sigma=0.6231$

**h**

```{r}
confint(model4, level=0.95)
confint(model4, "ACT", level =0.95)
```

**i** 95% CI for ACT=28

```{r}
confint(model4, "ACT", level = 0.9) #is this right?
```


**j** 95% PI for ACT=28

```{r}
#use predict function and create new data frame with just ACT=28 new.data<-data.frame(ACT=28)
ACT_28<- data.frame(ACT=28)
predict(model4,ACT_28,interval="confidence", level = 0.95, se.fit = T)
```
The prediction interval is (3.06, 3.34).

## Problem 5 

```{r}
age <- c(3, 4, 5, 6, 3, 4, 5, 6, 3, 4, 5, 6, 3, 4, 5, 6, 3, 4, 5, 6, 3, 4, 5, 6, 6) 
weight <- c(2.61, 2.67, 2.98, 3.98, 2.87, 3.41, 3.49, 4.03, 3.41, 2.81, 3.24, 3.75, 3.18, 3.13, 3.98, 4.55, 3.41, 3.35, 3.75, 3.83, 3.18, 3.52, 3.49, 3.81, 4.03) 
systolic_BP <- c(80, 90, 96, 102, 81, 96, 99, 110, 88, 90, 100, 102, 86, 93, 101, 103, 86, 91, 100, 105, 84, 91, 95, 104, 107) 
# Create a data frame 
infants <-data.frame(age, weight, systolic_BP)
```
**a**
$\hat{systolic BP}= \hat{\beta}_0 + \hat{\beta}_1 * age + \hat{\beta}_2 * weight + \epsilon$

**b**
```{r}
model5<- lm(systolic_BP ~ age+weight, data = infants)
model5
```
$\hat{systolic BP}= 57.264 + 5.804 * age + 3.316 * weight$


**c** estimated residual std dev
```{r}
summary(model5)
```
 Sd=SE*n^2 ## Check ???
 
The residual standard deviation is 1533.75
```{r}
2.454*25^2
```


**d**

The coefficient of weight is directly related to the systolic BP. As weight increases by one kgm, systolic BP increases by 3.316.

**e**
Can hypothesis be rejected alpha=0.01